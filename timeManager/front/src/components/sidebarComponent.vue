<template>
    <nav
        class="md:h-[calc(100%-2rem)] md:rounded-xl bg-[#f5f5f5] md:m-4 md:mr-0 py-2 md:px-4 md:py-6"
    >
        <section class="hidden md:flex flex-row gap-5 justify-center">
            <!-- Logo du site web -->
            <img :src="profileImage" alt="Logo de Batman" class="h-12 w-auto" />
            <div>
                <!-- Nom d'utilisateur -->
                <p>{{ currentUser.firstname }}</p>
                <p>{{ currentUser.lastname }}</p>
            </div>
        </section>

        <section class="flex flex-1 justify-center md:block sm:gap-3">
            <article class="md:mt-5 flex md:block">
                <p class="hidden md:block text-[#405D9F] mb-1 px-4">Menu</p>
                <ul class="flex md:block sm:gap-3">
                    <li
                        :class="[
                            component.type === 'dashboard' ? active : inactive,
                        ]"
                        @click="componentType('dashboard')"
                    >
                        <svg
                            class="md:mr-3"
                            xmlns="http://www.w3.org/2000/svg"
                            width="24"
                            height="24"
                            viewBox="0 0 24 24"
                            fill="none"
                        >
                            <path
                                d="M4.49934 7.02928C4.81483 6.93206 5.16339 7.04359 5.36229 7.31707C5.58329 7.62095 5.55714 8.039 5.3 8.31297L4.59565 8.83471C4.26191 9.11198 4.06776 9.52256 4.06522 9.95645V17.913C4.07474 19.2091 5.12562 20.2561 6.42174 20.2608H10.4217V20.2782C10.854 20.2782 11.2043 20.6286 11.2043 21.0608C11.2043 21.493 10.854 21.8434 10.4217 21.8434H6.42174C4.25781 21.8386 2.50478 20.0856 2.5 17.9217V9.95645C2.51384 9.03602 2.94588 8.17194 3.67391 7.60862L4.39565 7.06949L4.49934 7.02928ZM9.62174 2.79992C10.9421 1.73857 12.8231 1.73857 14.1435 2.79992L20.1522 7.59123C20.8642 8.16388 21.2822 9.02539 21.2913 9.93905L21.2826 17.913C21.2826 20.0789 19.5268 21.8347 17.3609 21.8347H15.6217C14.5734 21.8347 13.7222 20.9874 13.7174 19.9391V16.3391L13.7093 16.2484C13.6666 16.0131 13.4606 15.8347 13.213 15.8347H10.6043C10.4691 15.8347 10.3394 15.889 10.2446 15.9855C10.1498 16.082 10.0977 16.2125 10.1 16.3478V17.7217C10.1 18.1539 9.74961 18.5043 9.31739 18.5043C8.88517 18.5043 8.53478 18.1539 8.53478 17.7217V16.3478C8.53478 15.7966 8.75374 15.2679 9.14349 14.8782C9.53324 14.4884 10.0619 14.2695 10.613 14.2695H13.2217C14.3661 14.2743 15.2913 15.2033 15.2913 16.3478V19.9391C15.2913 20.1215 15.4392 20.2695 15.6217 20.2695H17.4043C18.701 20.2695 19.7522 19.2183 19.7522 17.9217V9.95645C19.7458 9.51519 19.5415 9.10015 19.1957 8.82601L13.187 4.03471C12.4293 3.41091 11.336 3.41091 10.5783 4.03471L8.64783 5.47819C8.29004 5.73512 7.79171 5.65336 7.53478 5.29558C7.27785 4.93779 7.35961 4.43947 7.71739 4.18253L9.62174 2.79992Z"
                                fill="black"
                            />
                        </svg>
                        Accueil
                    </li>
                    <li
                        :class="[
                            component.type === 'clock' ? active : inactive,
                        ]"
                        @click="componentType('clock')"
                    >
                        <svg
                            class="md:mr-3"
                            xmlns="http://www.w3.org/2000/svg"
                            width="24"
                            height="24"
                            viewBox="0 0 24 24"
                            fill="none"
                        >
                            <path
                                d="M15.0594 2C18.7106 2 21 4.27265 21 7.94063V10.1464L20.9934 10.2451C20.9452 10.5999 20.6411 10.8734 20.2731 10.8734H20.2647L20.1499 10.8642C19.9991 10.8398 19.8588 10.7677 19.7506 10.657C19.6154 10.5186 19.5417 10.3315 19.5462 10.1381V7.94063C19.5462 5.04969 17.9503 3.45383 15.0594 3.45383H7.94063C5.04134 3.45383 3.45383 5.04969 3.45383 7.94063V15.0677C3.45383 17.9587 5.04969 19.5462 7.94063 19.5462H15.0594C17.9587 19.5462 19.5462 17.9503 19.5462 15.0677C19.5462 14.6663 19.8716 14.3408 20.2731 14.3408C20.6746 14.3408 21 14.6663 21 15.0677C21 18.7274 18.7274 21 15.0677 21H7.94063C4.27265 21 2 18.7274 2 15.0677V7.94063C2 4.27265 4.27265 2 7.94063 2H15.0594ZM7.46438 9.17722C7.65721 9.18376 7.83953 9.26668 7.97117 9.40773C8.10282 9.54878 8.17299 9.73638 8.16623 9.9292V16.0035C8.15238 16.405 7.81571 16.7192 7.41425 16.7054C7.01278 16.6915 6.69856 16.3548 6.7124 15.9534V9.87071L6.72535 9.75704C6.7545 9.60803 6.83036 9.47102 6.94341 9.36676C7.08472 9.23644 7.27236 9.16817 7.46438 9.17722ZM11.5334 6.32806C11.9349 6.32806 12.2603 6.65351 12.2603 7.05497V15.9617C12.2603 16.3632 11.9349 16.6887 11.5334 16.6887C11.132 16.6887 10.8065 16.3632 10.8065 15.9617V7.05497C10.8065 6.65351 11.132 6.32806 11.5334 6.32806ZM15.5607 12.3857C15.9621 12.3857 16.2876 12.7111 16.2876 13.1126V15.9534C16.2876 16.3548 15.9621 16.6803 15.5607 16.6803C15.1592 16.6803 14.8338 16.3548 14.8338 15.9534V13.1126C14.8338 12.7111 15.1592 12.3857 15.5607 12.3857Z"
                                fill="black"
                            />
                        </svg>
                        Pointeuse
                    </li>
                    <li
                        v-if="currentUser.role === 'supermanager'"
                        :class="[
                            component.type === 'workingTimes'
                                ? active
                                : inactive,
                        ]"
                        @click="componentType('workingTimes')"
                    >
                        <svg
                            class="md:mr-3"
                            xmlns="http://www.w3.org/2000/svg"
                            width="24"
                            height="24"
                            viewBox="0 0 24 24"
                            fill="none"
                        >
                            <path
                                d="M15.1393 2C18.1742 2 19.9918 3.85386 20 6.94923V16.0508C20 19.1461 18.1906 21 15.1476 21H12.4499C12.104 20.9611 11.8421 20.6629 11.8421 20.3079C11.8421 19.953 12.104 19.6548 12.4499 19.6159H15.1393C17.4586 19.6159 18.6265 18.4163 18.6265 16.0508V6.94923C18.6265 4.58366 17.4586 3.38411 15.1393 3.38411H7.85244C5.53314 3.38411 4.35704 4.58366 4.35704 6.94923V16.0508C4.35704 18.4163 5.53314 19.6159 7.85244 19.6159C8.1984 19.6548 8.46026 19.953 8.46026 20.3079C8.46026 20.6629 8.1984 20.9611 7.85244 21C4.81761 21 3 19.1461 3 16.0508V6.94923C3 3.84547 4.81761 2 7.85244 2H15.1393ZM14.8926 14.8344C15.2651 14.8344 15.567 15.1424 15.567 15.5223C15.567 15.9022 15.2651 16.2102 14.8926 16.2102H8.08273C7.71026 16.2102 7.40832 15.9022 7.40832 15.5223C7.40832 15.1424 7.71026 14.8344 8.08273 14.8344H14.8926ZM14.8926 10.8079C15.1528 10.7787 15.4066 10.9038 15.5457 11.13C15.6848 11.3563 15.6848 11.6437 15.5457 11.87C15.4066 12.0962 15.1528 12.2213 14.8926 12.1921H8.08273C7.73677 12.1531 7.47491 11.855 7.47491 11.5C7.47491 11.145 7.73677 10.8469 8.08273 10.8079H14.8926ZM10.6817 6.78985C11.0276 6.82875 11.2895 7.1269 11.2895 7.4819C11.2895 7.83689 11.0276 8.13504 10.6817 8.17395H8.09095C7.745 8.13504 7.48314 7.83689 7.48314 7.4819C7.48314 7.1269 7.745 6.82875 8.09095 6.78985H10.6817Z"
                                fill="black"
                            />
                        </svg>
                        Statistiques
                    </li>
                </ul>
            </article>

            <article class="md:mt-5 flex md:block">
                <p class="hidden md:block text-[#405D9F] mb-1 px-4">
                    Paramètres
                </p>
                <ul class="flex md:block sm:gap-3">
                    <li
                        :class="[
                            component.type === 'teamComponent'
                                ? active
                                : inactive,
                        ]"
                        @click="componentType('teamComponent')"
                    >
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke-width="1.5"
                            stroke="black"
                            width="24"
                            height="24"
                            class="md:mr-3"
                        >
                            <path
                                class="noClose"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"
                            />
                        </svg>

                        Equipe
                    </li>
                    <li
                        :class="[
                            component.type === 'userComponent'
                                ? active
                                : inactive,
                        ]"
                        @click="componentType('userComponent', 'edit')"
                    >
                        <svg
                            class="md:mr-3"
                            xmlns="http://www.w3.org/2000/svg"
                            width="24"
                            height="24"
                            viewBox="0 0 24 24"
                            fill="none"
                        >
                            <path
                                d="M20 18.3301C20 21.619 15.4345 22 12 22C11.6538 22 11.3127 21.995 10.9776 21.985C10.5791 21.975 10.2652 21.644 10.2772 21.247C10.2883 20.851 10.6325 20.553 11.0189 20.55C11.3409 20.559 11.6679 20.563 12 20.563C16.3492 20.563 18.555 19.8121 18.555 18.3301C18.555 16.8341 16.3492 16.0751 12 16.0751C7.65082 16.0751 5.44503 16.8271 5.44503 18.3101C5.44503 18.7951 5.61811 19.4981 7.1205 20.004C7.49887 20.131 7.70113 20.538 7.57333 20.913C7.44453 21.288 7.03597 21.493 6.6566 21.363C4.46088 20.624 4 19.2951 4 18.3101C4 15.0873 8.38109 14.6559 11.7884 14.6397L12.3808 14.6399C14.6531 14.6515 20 14.8521 20 18.3301ZM12 2C14.9706 2 17.3867 4.40194 17.3867 7.35387C17.3867 10.3048 14.9706 12.7067 12 12.7067C9.02943 12.7067 6.61233 10.3048 6.61233 7.35387C6.61233 4.40194 9.02943 2 12 2ZM12 3.43696C9.82642 3.43696 8.05836 5.19392 8.05836 7.35387C8.05836 9.51281 9.82642 11.2698 12 11.2698C14.1736 11.2698 15.9416 9.51281 15.9416 7.35387C15.9416 5.19392 14.1736 3.43696 12 3.43696Z"
                                fill="black"
                            />
                        </svg>
                        Profil
                    </li>
                    <li :class="[inactive]">
                        <svg
                            class="md:mr-3"
                            xmlns="http://www.w3.org/2000/svg"
                            width="24"
                            height="24"
                            viewBox="0 0 24 24"
                            fill="none"
                        >
                            <path
                                d="M14.016 14.8441C14.4092 14.8441 14.7284 15.1391 14.7284 15.5025V16.3071C14.7284 18.3985 12.8872 20.1 10.6231 20.1H6.11357C3.84583 20.1 2 18.3942 2 16.2977C2 15.9343 2.3192 15.6401 2.71243 15.6401C3.10565 15.6401 3.42485 15.9343 3.42485 16.2977C3.42485 17.6691 4.63135 18.7832 6.11357 18.7832H10.6231C12.1017 18.7832 13.3035 17.6726 13.3035 16.3071V15.5025C13.3035 15.1391 13.6227 14.8441 14.016 14.8441ZM20.2874 10.8909C20.576 10.8909 20.836 11.0517 20.9461 11.2988C21.0562 11.545 20.9942 11.8289 20.7907 12.017L18.0872 14.5043C17.9475 14.6317 17.7661 14.6967 17.5838 14.6967C17.4016 14.6967 17.2184 14.6317 17.0796 14.5026C16.802 14.2444 16.802 13.828 17.0814 13.5715L18.5627 12.2085H9.17164C8.77842 12.2085 8.45829 11.9136 8.45829 11.5502C8.45829 11.1868 8.77842 10.8909 9.17164 10.8909H20.2874ZM10.6141 3C12.8827 3 14.7286 4.70579 14.7286 6.80234V7.59837C14.7286 7.96091 14.4094 8.2559 14.0161 8.2559C13.6229 8.2559 13.3037 7.96091 13.3037 7.59837V6.80234C13.3037 5.43086 12.0972 4.31675 10.6141 4.31675H6.10543C4.62691 4.31675 3.42504 5.4283 3.42504 6.79293V13.304C3.42504 13.6674 3.10584 13.9624 2.71261 13.9624C2.31939 13.9624 2.00019 13.6674 2.00019 13.304V6.79293C2.00019 4.70152 3.84139 3 6.10543 3H10.6141ZM17.0777 8.60039C17.3553 8.34046 17.805 8.33875 18.0853 8.59526L18.7663 9.21772C19.0466 9.47423 19.0485 9.89064 18.7718 10.1489C18.6321 10.2788 18.4489 10.3447 18.2657 10.3447C18.0844 10.3447 17.903 10.2805 17.7643 10.154L17.0824 9.53067C16.8029 9.27501 16.8011 8.85775 17.0777 8.60039Z"
                                fill="black"
                            />
                        </svg>
                        Déconnexion
                    </li>
                </ul>
            </article>
        </section>
    </nav>
</template>

<script>
import { mapGetters, mapActions } from "vuex";
export default {
    name: "SidebarComponent",
    data() {
        return {
            show: false,
            active: "flex flex-col md:flex-row items-center py-2.5 px-2 md:px-4 rounded-lg hover:bg-gray-200 group text-xs md:text-base text-[#2990F1] bg-white shadow-lg shadow-gray-200 hover:!bg-white transition-all duration-200 activated-link",
            inactive: "flex flex-col md:flex-row items-center py-2.5 px-2 md:px-4 rounded-lg hover:bg-gray-200 group text-xs md:text-base text-[#444] md:text-[black] transition-all duration-200",
        };
    },

    props: {
        profileImage: String,
        username: String,
    },

    computed: {
        ...mapGetters("component", ["getComponent"]),
        ...mapGetters("user", ["currentUser"]),
        component() {
            return this.getComponent;
        },
    },

    methods: {
        ...mapActions("component", ["showComponent"]),
        ...mapActions("user", ["getUser"]),
        async componentType(type, childrenType) {
            if (type === this.component.type) {
                await this.toggleShow(type, childrenType);
                return;
            }
            await this.setComponent(type, childrenType, true);
        },
        async toggleShow(type, childrenType) {
            this.show = !this.show;
            await this.setComponent(type, childrenType, this.show);
        },
        async setComponent(type, childrenType, show) {
            const payload = { type, show };
            if (childrenType) {
                await this.getUser(this.currentUser.id);
                payload.childrenType = childrenType;
            }
            this.showComponent(payload);
        },
    },
};
</script>

<style scoped>
.activated-link svg path {
    fill: #2990f1;
}

.activated-link svg path.noClose {
    fill: none;
    stroke: #2990f1;
}
</style>
